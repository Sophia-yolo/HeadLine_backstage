## 目录结构

![图片](http://139.196.138.42/wp-content/uploads/2021/01/jLbYP79MTSJ82vc20210123.png)

`root`

- 最上头的root为根目录/，不是root用户
- 此外，在根目录/下还有一个root文件夹，是root用户的家目录
  - 除了root用户，其它用户都无法进入

`bin`、`sbin` 

- 二进制/[系统的]

**etc**

- 配置文件夹【全局】

`opt` 

- 可选的，存在意义不是很强，用户可选择地放文件

`run` 

- 当前正在跑的文件，一般不关注

`var`

-  动态数据

- mail 系统的通知机制，不是e-mail
- log 日志【重要，勿修改】
  - 查看信息一般需要`sudo`权限，一般要查看error、warning的位置
  - last显示的登录信息就存放在`wtmp`文件中

`boot`

-  内核文件，启动相关

home

 PS：所有用户的家的父目录

- 用户的家都在home下，路径为${HOME}或~

lib、`lib64` 库

media 媒体 [早期挂载软盘、光驱用，U盘不在这，现在都用得少了]

`mnt` 挂载目录

- 挂载其它的文件系统，如U盘、WSL中的CD…盘
- 约定俗成的挂载点，不会自动挂载，也可以有其他任意位置的挂载点

`proc`

 进程

- 通过`ps`查看对应进程id后，可在`proc`目录下找到对应id的目录
- 目录里的文件大都是0 KB，因为都不是真的，只是为了显示
- 其中有一个`fd`目录→文件描述符file descriptor
  - [![图片](http://139.196.138.42/wp-content/uploads/2021/01/wz8Cq25sFU7girL20210123.png)](http://139.196.138.42/index.php/2021/01/15/basic-system/wz8cq25sfu7girl20210123/)图片
  - 可以往`stdout【#1】`输入 abc，即会在终端显示
  - 暂时不管10是做什么的

`tmp` 临时文件夹

- 关机就会清空，不是缓冲
- [PS] `tmpfile`命令，可创建临时文件，参考man `tmpfile`

`dev` 设备文件

`usr`

用户主动安装的文件

- 一般是管理员用户，普通用户无法安装软件
- local 共享文件[手册…]



## 启动流程

1. 👉按下开机键

2. 👉加载BIOS：硬件检测[CPU、磁盘、内存条等]，读取配置[系统安装位置等]，直到读取`MBR`
   - BIOS——基本输入输出系统，基于CMOS芯片的固件
     - 固件是基于软件和硬件的，将一些程序固化[烧制]在一个芯片上
     - 一直上电的[纽扣电池]，掉电就会初始化

3. 👉读取第一个可启动设备内的`MBR` [主引导分区]
   - 存储了引导程序 Boot , Loader
   - 加载kernel：检测硬件，加载驱动
   - 此时kernel接手BIOS的工作

4. 👉执行引导程序 `[Ubuntu：Grub]`
   - 加载**虚拟文件系统**，把内核kernel跑起来

5. 👉初始化磁盘，读取系统镜像文件

6. 👉启动1号进程
   - 早期叫 `init`，现在叫`cnd`
   - 此时系统有自己的功能了

7. 👉加载磁盘，**挂载数据**，**启动各种服务**，连接终端 getty

8. 👉【最后】**运行x windows系统**→有图形化界面



### 运行级别

Linux下，不同的运行级别（run level）对应不同的服务来启动系统

| run level | 含义                    | 备注                                             |
| :-------- | :---------------------- | :----------------------------------------------- |
| 0         | halt                    | 系统关机                                         |
| 1         | single user mode        | 在系统出问题时维护用，类似安全模式               |
| 2         | multi-user, without nfs | `nfs：network file system`  //多用户，纯文本模式 |
| 3         | full multi-user mode    | 完整的多用户纯文本模式【常用】                   |
| 4         | unused                  | 系统保留，没有用                                 |
| 5         | `X11`                   | 在run level 3的基础上加载X windows               |
| 6         | reboot                  | 重启                                             |

- 启动方式发展
  - System V [依次启动]
  - Upstart [分组启动，没有依赖关系的服务可以同时启动]
  - Systemd[全部服务一起启动，有依赖关系的服务再稍稍滞后，进一步提高并发性]
- 系统启动速度并不代表系统性能的好坏，如大型机器，几年重启一次，要好好检查一下硬件
- 热启动：在没有必要的情况下，跳过BIOS的硬件检测过程，加快启动速度



PS：传统的`System V init` ——>  upstart方式



### 配置文件

#### 文件系统

|              |                                                              |
| ------------ | ------------------------------------------------------------ |
| /`etc/fstab` | 开机时挂载的文件系统（静态文件系统信息，指示需要挂载的系统盘）<!--如：需给公司机器挂载一个其它的磁盘，可以在这设置--> |
| `/etc/mtab`  | 当前挂载的文件系统                                           |

#### 用户系统

|                       |          |                                                     |
| --------------------- | -------- | --------------------------------------------------- |
| `/etc/passwd`         | 用户信息 | 不仅有普通的用户，还有非常多系统用户                |
|                       |          | `用户:密码占用符:uid:gid:用户描述:家目录:默认shell` |
| `/etc/shadow`         | 用户密码 | 显示的密码加密了，解密成本也许大于获取的价值        |
| `/etc/group`          | 群组信息 |                                                     |
| `/etc/gshadow`        | 群组密码 | 基本不用，root来管整个体系即可，没必要细分到组      |
| `/etc/sudoers Sudoer` | 列表     | %代表组；可自己添加                                 |



#### shell

- echo ${SHELL} 查看该用户的Shell类型
- /etc/shells 可用的Shells列表

```c
cat /etc/shells
```

【针对`zsh`】

- `/etc/zsh/zprofile` 用户首选项【全局】

- 在man `zsh`里搜索——FILES，即可看到所有可配置`zsh`的文件路径

  - 举例：在4个全局配置、4个用户配置里echo “In …”

  - 在用户登录`zsh`时，显示顺序如下：

  - [![图片](http://139.196.138.42/wp-content/uploads/2021/01/fZXuSCQa3kc72Kx20210123.png)](http://139.196.138.42/index.php/2021/01/15/basic-system/fzxuscqa3kc72kx20210123/)

  - 顺序：`zshenv→zprofile→zshrc→zlogin`，先全局(G)，再用户(L)

  -  用户配置文件

    ```shell
    - $ZDOTDIR/.zshenv
    - $ZDOTDIR/.zprofile
    - $ZDOTDIR/.zshrc
    - $ZDOTDIR/.zlogin
    - $ZDOTDIR/.zlogout
    - $ZDOTDIR——默认为用户的家目录
    ```

    

#### 系统环境

- `/etc/environment` 环境变量
  - PATH环境变量：${PATH}
  - which 命令，会在这【PATH环境变量】里面的路径找命令对应的文件【文件需可执行】
  - PATH添加路径”.”：PATH=${PATH}:.
    - 可直接在PATH变量后添加:.，即可连接
    - 还可使用`export PATH=${PATH}:.`
    - `evn`
    - ❗但两种方式都是在内存中修改，重连shell后就会消失
- `/etc/updatedb.conf` 文件检索数据库配置信息
  - `updatedb` 更新数据库 [更新后，可以使刚被创建的文件被locate找到，数据库不是实时更新的]
- /etc/issue、`/etc/issue.net` 发行信息、[远程登录时的显示]
- `/etc/os-release` 更详细的系统信息

[![图片](http://139.196.138.42/wp-content/uploads/2021/01/k9wEGshH8myqrLt20210123.png)](http://139.196.138.42/index.php/2021/01/15/basic-system/k9wegshh8myqrlt20210123/)



常见环境变量：PATH、HOME、SHELL、LANG、HISTORY



#### 网络

- `/etc/hosts` 主机列表
  - 也叫静态`DNS`，可以写对应关系
  - ❗域名[主机名]→`IP`地址
  - [自己的理解]类似windows的hosts，对于一个名称的解析先找hosts，再使用`DNS`
- `/etc/hostname` 主机名
  - ①需要sudo权限修改→新的主机名
  - ②**重启主机**；或者使用[hostname] 新的主机名]**临时修改内存**中的主机名，否则改了后，环境里的主机名并没有变
  - ③再重连即可
  - [自己的理解] 第①步改的是真正的主机名，第②步hostname用来临时修改内存里的主机名，直接重启也可刷新内存
- `/etc/resolv.conf` 域名解析服务器地址
  - DNS 动态域名服务器
  - ❗域名→ IP 地址
- /etc/network/interfaces 网卡配置文件，先自行查看